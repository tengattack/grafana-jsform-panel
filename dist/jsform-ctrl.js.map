{"version":3,"sources":["../src/jsform-ctrl.js"],"names":["MetricsPanelCtrl","_","contextSrv","kbn","canvasRendering","JsformOptionsEditor","panelDefaults","jsonSchema","submitButtonText","submitConfirmMsg","formActionUrl","formContentType","refreshOnSuccess","ajaxCredentials","ajaxSuccessPath","ajaxFailurePath","uploadHandler","JSFormCtrl","$scope","$injector","$rootScope","timeSrv","onDataReceived","dataList","data","transformData","render","onInitEditMode","addEditorTab","unitFormats","getUnitFormats","onRender","onSubmit","events","emit","theme","user","lightTheme","defaultsDeep","panel","on","scope","elem","attrs","ctrl","templateUrl"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,sB,kBAAAA,gB;;AACFC,O;;AACEC,gB,gBAAAA,U;;AACFC,S;;AAEAC,qB;;AACEC,yB,kBAAAA,mB;;;;;;;;;;;;;;;;;;;;;AAIHC,mB,GAAgB;AACpBC,oBAAY,EADQ;AAEpBC,0BAAkB,QAFE;AAGpBC,0BAAkB,EAHE;AAIpBC,uBAAe,EAJK;AAKpBC,yBAAiB,YALG;AAMpBC,0BAAkB,IANE;AAOpBC,yBAAiB,KAPG;AAQpBC,yBAAiB,MARG;AASpBC,yBAAiB,MATG;;AAWpBC,uBAAe;AAXK,O;;4BAcTC,U;;;AAGX,4BAAYC,MAAZ,EAAoBC,SAApB,EAA+BC,UAA/B,EAA2CC,OAA3C,CAAmD,kBAAnD,EAAuE;AAAA;;AAAA,8HAC/DH,MAD+D,EACvDC,SADuD;;AAAA,gBAmBvEG,cAnBuE,GAmBtD,UAACC,QAAD,EAAc;AAC7B,kBAAKA,QAAL,GAAgBA,QAAhB;AACA,kBAAKC,IAAL,GAAY,MAAKC,aAAL,CAAmBF,QAAnB,CAAZ;AACA,kBAAKG,MAAL;AACD,WAvBsE;;AAAA,gBAyBvEC,cAzBuE,GAyBtD,YAAM;AACrB,kBAAKC,YAAL,CAAkB,SAAlB,EAA6BvB,mBAA7B,EAAkD,CAAlD;AACA,kBAAKwB,WAAL,GAAmB1B,IAAI2B,cAAJ,EAAnB;AACD,WA5BsE;;AAAA,gBA8BvEC,QA9BuE,GA8B5D,YAAM;AACf,gBAAI,CAAC,MAAKR,QAAV,EAAoB;AAAE;AAAS;AAC/B,kBAAKC,IAAL,GAAY,MAAKC,aAAL,CAAmB,MAAKF,QAAxB,CAAZ;AACD,WAjCsE;;AAAA,gBAmCvES,QAnCuE,GAmC5D,YAAM;AACf,kBAAKC,MAAL,CAAYC,IAAZ,CAAiB,QAAjB;AACD,WArCsE;;AAGrE,gBAAKX,QAAL,GAAgB,IAAhB;AACA,gBAAKC,IAAL,GAAY,EAAZ;AACA,gBAAKH,OAAL,GAAeA,OAAf;AACA;AACA;AACA;AACA,gBAAKc,KAAL,GAAajC,WAAWkC,IAAX,CAAgBC,UAAhB,GAA6B,OAA7B,GAAuC,MAApD;;AAEApC,YAAEqC,YAAF,CAAe,MAAKC,KAApB,EAA2BjC,aAA3B;;AAEA,gBAAK2B,MAAL,CAAYO,EAAZ,CAAe,eAAf,EAAgC,MAAKlB,cAArC;AACA,gBAAKW,MAAL,CAAYO,EAAZ,CAAe,oBAAf,EAAqC,MAAKlB,cAA1C;AACA,gBAAKW,MAAL,CAAYO,EAAZ,CAAe,gBAAf,EAAiC,MAAKb,cAAtC;AACA,gBAAKM,MAAL,CAAYO,EAAZ,CAAe,QAAf,EAAyB,MAAKT,QAA9B;AAhBqE;AAiBtE;;;;wCAsBaP,I,EAAM;AAClB,mBAAO,IAAP;AACD;;;+BAEIiB,K,EAAOC,I,EAAMC,K,EAAOC,I,EAAM;AAC7BxC,4BAAgBqC,KAAhB,EAAuBC,IAAvB,EAA6BC,KAA7B,EAAoCC,IAApC;AACD;;;6CAEkB;AACjB,iBAAKX,MAAL,CAAYC,IAAZ,CAAiB,oBAAjB;AACD;;;;QApD6BlC,gB;;;;AAAnBiB,gB,CACJ4B,W,GAAc,a","file":"jsform-ctrl.js","sourcesContent":["import { MetricsPanelCtrl } from 'app/plugins/sdk';\nimport _ from 'lodash';\nimport { contextSrv } from 'app/core/core';\nimport kbn from 'app/core/utils/kbn';\n\nimport canvasRendering from './canvas/rendering';\nimport { JsformOptionsEditor } from './options-editor';\nimport './css/jsform-panel.css!';\nimport './css/flatpickr.css!';\n\nconst panelDefaults = {\n  jsonSchema: '',\n  submitButtonText: 'Submit',\n  submitConfirmMsg: '',\n  formActionUrl: '',\n  formContentType: 'urlencoded',\n  refreshOnSuccess: true,\n  ajaxCredentials: false,\n  ajaxSuccessPath: 'info',\n  ajaxFailurePath: 'info',\n\n  uploadHandler: '',\n};\n\nexport class JSFormCtrl extends MetricsPanelCtrl {\n  static templateUrl = 'module.html';\n\n  constructor($scope, $injector, $rootScope, timeSrv /*, variableSrv */) {\n    super($scope, $injector);\n\n    this.dataList = null;\n    this.data = {};\n    this.timeSrv = timeSrv;\n    // DISABLED FOR Grafana 7.x\n    // this.variableSrv = variableSrv;\n    // this.variableNames = _.map(variableSrv.variables, 'name');\n    this.theme = contextSrv.user.lightTheme ? 'light' : 'dark';\n\n    _.defaultsDeep(this.panel, panelDefaults);\n\n    this.events.on('data-received', this.onDataReceived);\n    this.events.on('data-snapshot-load', this.onDataReceived);\n    this.events.on('init-edit-mode', this.onInitEditMode);\n    this.events.on('render', this.onRender);\n  }\n\n  onDataReceived = (dataList) => {\n    this.dataList = dataList;\n    this.data = this.transformData(dataList);\n    this.render();\n  }\n\n  onInitEditMode = () => {\n    this.addEditorTab('Options', JsformOptionsEditor, 2);\n    this.unitFormats = kbn.getUnitFormats();\n  }\n\n  onRender = () => {\n    if (!this.dataList) { return; }\n    this.data = this.transformData(this.dataList);\n  }\n\n  onSubmit = () => {\n    this.events.emit('submit');\n  }\n\n  transformData(data) {\n    return null;\n  }\n\n  link(scope, elem, attrs, ctrl) {\n    canvasRendering(scope, elem, attrs, ctrl);\n  }\n\n  updateJsonSchema() {\n    this.events.emit('update-json-schema');\n  }\n}\n"]}